#include "imagewindow.h"
/////////////////////////////////////////////////////////////////////////////////////
ImageWindow::ImageWindow(const QString &title,
                         const QPoint  &pos,
                         QWidget *parent) :
    QMainWindow(parent),
    _pos(pos)
{
    this->setWindowTitle(title);
    this->move(_pos);
}
/////////////////////////////////////////////////////////////////////////////////////
void ImageWindow::paintEvent(QPaintEvent *)
{
    QPainter painter(this);
    QPoint p(0, 0);
    painter.drawImage(p, _img);
}
/////////////////////////////////////////////////////////////////////////////////////
void ImageWindow::checkImgSize()
{
    if(_img.size() != _imgSize)
    {
        QRect rect;
        rect.setSize(_img.size());
        this->setGeometry(rect);
        this->move(_pos);
        _imgSize = _img.size();
    }
}
/////////////////////////////////////////////////////////////////////////////////////
void ImageWindow::inputFrame(FrameBox *f)
{
    f->lock().lockForRead();
    f->data().copyToQImage(_img);
    f->lock().unlock();

    this->drawAll();
    this->checkImgSize();
    update();
}
/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////
