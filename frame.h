#ifndef FRAME_H
#define FRAME_H
/////////////////////////////////////////////////////////////////////////////////////
#include <QtGlobal>
#include <string.h>
#include <QImage>
#include <QDebug>
#include "opencv.hpp"
/////////////////////////////////////////////////////////////////////////////////////
struct FrameHeader
{
    qint64  timeID;
    quint32 frameID;
    quint32 dataSize; // = depth * width * height
    quint32 depth;
    quint32 width;
    quint32 height;
    quint32 plug;
};
/////////////////////////////////////////////////////////////////////////////////////
class Frame
{
public:
    explicit Frame();
    explicit Frame(const Frame&);
    ~Frame();
    Frame& operator =(const Frame&);
    void attachRawData(const FrameHeader &header,
                       const void *data);
    void unattachRawData(); //do not forget!
    void lock();
    void unlock();
    bool isLocked();
    uchar* data();
    const FrameHeader& header();
    cv::Mat& asCvMat();
    QImage& asQImage();
private:
    uchar       *_data;
    FrameHeader  _header;
    bool    _locked;
    cv::Mat _cvmat;
    QImage  _qimg;
};
/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////

#endif // FRAME_H
