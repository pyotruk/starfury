#include "telescope.h"
/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////
const TelescopeStatus& telescope::findNearestByTime(const QDateTime &t,
                                                    const TelescopeVector &v,
                                                    qint64 &minDelay)
{
    qint64 dt;
    qint64 dtMin = 0xFFFFFFFF;
    TelescopeVector::const_iterator f = v.constBegin();
    for(TelescopeVector::const_iterator
        it = v.constBegin(); it < v.constEnd(); ++it)
    {
        QDateTime t0;
        timeutils::winfiletime2qdatetime(it->timeUTC, t0);
        dt = qAbs( t.time().msecsTo(t0.time()) );
        if(dt < dtMin)
        {
            dtMin = dt;
            f = it;
        }
    }
    minDelay = dtMin;
    return *f;
}
/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////

